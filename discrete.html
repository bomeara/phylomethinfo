<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Brian O’Meara" />


<title>DiscreteCharacters</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PhyloMeth</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="gettingstarted.html">Getting Started</a>
    </li>
    <li>
      <a href="https://github.com/bomeara/phylometh_gettingtreesanddata">Stealing Trees And Data</a>
    </li>
    <li class="dropdown-header">Building Trees</li>
    <li class="dropdown-header">Dating Trees</li>
    <li>
      <a href="https://github.com/bomeara/phylometh_discrete">Discrete Traits</a>
    </li>
    <li>
      <a href="https://github.com/bomeara/phylometh_continuous">Continuous Traits</a>
    </li>
    <li class="dropdown-header">Diversification</li>
    <li class="dropdown-header">Simulation</li>
  </ul>
</li>
<li>
  <a href="https://www.youtube.com/channel/UCoE9-jWQBwC3iyzMBE3nJNA/">Videos</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://bookdown.org/bomeara/comparative-methods/">HTML version</a>
    </li>
    <li>
      <a href="https://bookdown.org/bomeara/comparative-methods/comparative-methods.pdf">PDF version</a>
    </li>
    <li>
      <a href="https://github.com/bomeara/ComparativeMethodsInR">Git repo</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">DiscreteCharacters</h1>
<h4 class="author"><em>Brian O’Meara</em></h4>
<h4 class="date"><em>12 February, 2018</em></h4>

</div>


<p>For this exercise, explore looking at discrete character models. Note: they are not “discreet” character models – they’re actually pretty noisy.</p>
<p>Remember for homework,</p>
<p><code>git remote -v</code> gives list of remotes</p>
<p><code>git fetch upstream</code></p>
<p><code>git pull upstream master</code> pulls from upstream (me).</p>
<p>change <code>eval=TRUE</code> for all the R blocks, debug, commit, and do a pull request.</p>
<p>These are useful packages in this area (far from exhaustive list).</p>
<pre class="r"><code>library(yearn)
yearn::yearn(ape)
yearn::yearn(geiger)
yearn::yearn(phytools)
yearn::yearn(phangorn)
yearn::yearn(corHMM)</code></pre>
<p>You’ll need to get data into R in some way.</p>
<pre class="r"><code>tree &lt;- read.tree(&quot;____PATH_TO_TREE_OR_SOME_OTHER_WAY_OF_GETTING_A_TREE____&quot;)
discrete.data &lt;- read.csv(file=&quot;____PATH_TO_DATA_OR_SOME_OTHER_WAY_OF_GETTING_TRAITS____&quot;, stringsAsFactors=FALSE) #death to factors.</code></pre>
<p>Data are often not right in some way. They might not match the taxa in your tree, there may be missing data, etc. <code>geiger::treedata</code> is a great function for getting a tree and data that match, but your data may need other cleaning. Do it as a function so it’s repeatable.</p>
<pre class="r"><code>CleanData &lt;- function(phy, data) {
    #treedata() in Geiger is probably my favorite function in R.
}

# Now write the code to use CleanData() to actually clean your data</code></pre>
<p>It’s critically important to LOOK at what you have. Are there weird values? Has the match between taxa and state gone correctly? Do you think you have binary data, but there’s actually only state 1? Especially as data sets grow (yay), and are assembled using scripts rather than by error-prone, non-reproducable hands (double yay), scientists are increasingly less likely to deeply look at our data. That’s bad – don’t be that person.</p>
<pre class="r"><code>VisualizeData &lt;- function(phy, data) {
    #Important here is to LOOK at your data before running it. Any weird values? Does it all make sense? What about your tree? Polytomies?
    
    # Now write the code to use VisualizeData() to actually look at your data

}</code></pre>
<p>First, let’s use parsimony to look at ancestral states:</p>
<pre class="r"><code>cleaned.discrete.phyDat &lt;- phangorn::phyDat(cleaned.discrete, type=&quot;______________&quot;) #phyDat is a data format used by phangorn
anc.p &lt;- phangorn::ancestral.pars(tree, cleaned.discrete.phyDat)
plotAnc(tree, anc.p, 1)</code></pre>
<p>Do you see uncertainty? What does it mean?</p>
<p>Now, plot the likelihood estimates.</p>
<pre class="r"><code>anc.ml &lt;- ancestral.pml(pml(tree, cleaned.discrete.phyDat), type=&quot;ml&quot;)
plotAnc(tree, anc.ml, 1)</code></pre>
<p>How does this differ from parsimony?</p>
<p>Why does it differ from parsimony?</p>
<p>What does uncertainty mean?</p>
<p>Now, to the biological questions. For many of these, <code>corHMM</code> will be a useful package.</p>
<ol type="1">
<li>How can you estimate transition rates between states? Do it.</li>
<li>How could you examine if transition rates are equal?</li>
<li>Think about the Lewis (2001) MKV model. Are your traits all variable? Will using this make sense for your data? Try using it. Do results change?</li>
<li>How could you test order of state evolution?</li>
</ol>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
